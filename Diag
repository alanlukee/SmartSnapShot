sequenceDiagram
  User->>+MainWindow: Open Application
  MainWindow-->>-User: Display Timer button enabled (Start and Stop disabled)

  User->>+MainWindow: Click Timer button
  MainWindow-->>-User: Show options (User Demand, Timer Interval)

  User->>+MainWindow: Select mode (User Demand / Timer Interval)
  alt User Demand Mode
    MainWindow->>+ScreenshotManager: Set UserDemand flag = true
  else Timer Interval Mode
    MainWindow-->>-User: Show interval options
    User->>+MainWindow: Select interval
  end
  MainWindow-->>-User: Enable Start button

  User->>+MainWindow: Click Start button
  MainWindow->>+ScreenshotManager: Minimize to taskbar and prompt folder selection
  User-->>-ScreenshotManager: Select folder

  alt User Demand Mode
    ScreenshotManager->>+PopupFrame: Show camera icon
    loop On camera icon click
      User->>+PopupFrame: Click camera icon
      PopupFrame-->>-ScreenshotManager: Capture screenshot
      ScreenshotManager->>ScreenshotManager: Run takeScreenshot()
      ScreenshotManager->>+PopupFrame: Show camera icon again
    end
  else Timer Interval Mode
    ScreenshotManager->>+Timer: Create Timer object
    loop At intervals
      Timer->>+ScreenshotManager: Capture screenshot
      ScreenshotManager->>ScreenshotManager: Run takeScreenshot()
    end
  end
  MainWindow-->>-User: Enable Stop button

  User->>+MainWindow: Click Stop button
  alt User Demand Mode
    ScreenshotManager->>ScreenshotManager: Set UserDemand flag = false
    ScreenshotManager->>+PopupFrame: Close camera icon
  else Timer Interval Mode
    ScreenshotManager->>+Timer: Stop and destroy Timer object
  end
  ScreenshotManager-->>-MainWindow: Enable Preview window

  MainWindow->>+PreviewWindow: Open Preview window
  PreviewWindow->>+ScreenshotManager: Fetch saved screenshots
  User->>+PreviewWindow: Select images and click Export to PDF
  PreviewWindow->>+ScreenshotManager: Compile selected images into PDF
  ScreenshotManager-->>-User: Open PDF in browser
